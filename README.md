# BatVenti

温迪将会让你的 Windows 批处理起飞

BatVenti 是一个用于在 Windows 批处理脚本运行过程中调用的程序。
在你的批处理当中，使用指令调用 BatVenti 并给定要调用的功能名称和参数，就可以执行对应的操作。
有的功能是根据结果不同返回不同的退出数值，也就是 ERRORLEVEL ；
而有的则是向命令窗口输出文字，需要使用 FOR /F 来进行捕获。

## 如何使用

本程序具有许多功能，目前已经实现的功能如下：

- msgbox 从命令行参数获得信息，然后弹出一个消息框。
- inputbox 弹出一个输入框，然后将用户输入的内容输出给命令行窗口。
- coloredecho 可以以特定的颜色输出一段文本，不波及其他文本。
- ntraiseharderror 通过给定的错误代码产生不同的效果，弹窗或者是蓝屏。
- GUIDGen 生成一个随机的 GUID。
- seterrorlevel 直接返回给定的数字作为 ERRORLEVEL。

你可以在你的批处理需要用到某个功能时，插入一行调用 BatVenti 的指令即可。
指令格式如下：

batventi <功能名称> <其他参数>

其中，功能名称的开头，不需要加上 '/' 或者 '-' 符号。
任何功能，都可以通过 "batventi <功能名称> help" 的方式获得帮助。
本程序本体也可以通过 "batventi help" 来获得帮助。

## 如何制作插件

插件功能尚未实现，不过目前开发规范已经明确了。

1. 如果某个功能，运行过程中和完成后，没有文本需要交给批处理进行处理，只需要退出数值 ERRORLEVEL，那么调用的批处理可以直接进行调用，然后使用 IF ERRORLEVEL X 或者 IF %ERRORLEVEL%==N 这样的语句进行对应的分支处理。例如 seterrorlevel 功能。
2. 如果某个功能，运行过程中和完成后，需要将文本交给批处理进行处理，那么批处理就需要使用 FOR /F 语句进行捕获，而退出数值 ERRORLEVEL 就不能被批处理捕获了，同时程序输出的任何文本，都只对批处理可见，而对用户不可见。
另外，如果有些内容是在运行过程中，为用户显示的提示文本，而不给批处理进行处理，那么这里建议使用一个约定好的注释字符，然后批处理在捕获时就将该字符设为注释字符，从而忽略，不进行读取处理。
例如，本程序所有内置功能，都将 '-' (短划线，Dash，Hyphen)作为注释字符，那么所有的“不给批处理读取处理”的文本，它们的每一行都应该以 '-' 开头。而批处理运行时，就用这样的方式读取：

    FOR /F "eol=- tokens=*" %%A IN ('batventi <function name> <more parameters>') DO @ECHO %%A

   这样，程序输出的以 '-' 开头的文本，就不会被批处理捕获处理。（但是最终用户也是看不到的，建议用于输出错误文本或者帮助文本）

3. 如果你的功能实在需要“既向用户输出提示文本和给批处理传递退出数值 ERRORLEVEL ，又要输出文本给批处理进行捕获处理”，那么建议将文本输出到一个文本文件，然后批处理不套 FOR /F 直接调用，调用完了之后，根据 ERRORLEVEL ，判断要不要再用 FOR /F 去读取存储输出内容的文本文档。
4. 插件应当和本程序一样，也是纯命令行 Windows 程序，无论什么语言做的都可以，但应当是从命令行捕获参数并输出文本的命令行程序。通过输出的文本或者退出数值来传达运行结果信息，应当是独立的 exe 文件，可以拿出来单独使用。还可以是 bat cmd ps1 文件，本程序会使用 system() 函数，也就是 cmd /c ... 来运行。
5. 插件应当可以在用 intro 参数运行时，在一行内输出自己的名称、功能一句话介绍、版本号（可选），例如"sayhi 1.0.0 Print a Ciallo world!"；而在 help 参数运行时，应当能显示完整的帮助信息。至于 version 或者 about 参数的支持则是可选的。
6. 本程序的源代码当中有 btvenlib.h 这个文件，它还包含了 hyphen.h 这个文件，里面有一些为这个程序制作插件的时候会很常用的函数封装和宏定义，可以直接调用，因此如果你是用 C/C++ 做插件，那就可以包含 btvenlib.h 这个文件。
7. 插件无需注册等等，只需要放在本程序同一文件夹下的 plugin 文件夹里就可以了，调用的时候就运行：

    batventi plugin <插件名称> <其他参数>

    本程序会自动扫描调用。（反正就是，在文件系统里注册了，就是注册了，不需要别的注册）。
   
8. 插件最好不要要求管理员权限或者提升的特权，否则，要么批处理也必须以管理员身份运行，要么你的插件会另开一个窗口运行，无法和批处理进行交互，要么插件无法运行。
9. 本程序支持 x86 x64 ARM32 架构，将来会支持 ARM64 ，你的插件可以不完全支持这些架构，根据具体适用范围而确定。
